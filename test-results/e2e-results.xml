<testsuites id="" name="" tests="2" failures="0" skipped="0" errors="0" time="28.376296">
<testsuite name="simple-homepage-widget-test.spec.ts" timestamp="2025-08-04T01:41:42.943Z" hostname="chromium" tests="2" failures="0" skipped="0" time="30.127" errors="0">
<testcase name="Simple homepage widget bidirectional test" classname="simple-homepage-widget-test.spec.ts" time="27.871">
<system-out>
<![CDATA[🎯 SIMPLE HOMEPAGE WIDGET BIDIRECTIONAL TEST
==============================================
🏠 Step 1: Testing homepage widget...
📋 Widget button exists: YES
✅ Widget opened
💬 Sending message from widget: SIMPLE TEST: Widget message 1754271710500
✅ Widget message sent
📥 Step 2: Checking dashboard...
✅ Agent logged in
📋 Dashboard conversations found: 38
✅ Widget message found in conversation 3
💬 Step 3: Testing dashboard to widget...
✅ Dashboard reply sent: SIMPLE TEST: Dashboard reply 1754271728145
📋 Dashboard reply in widget: NO

🎯 SIMPLE TEST SUMMARY
======================
📋 Widget button found: YES
📋 Dashboard conversations: 38
📋 Widget → Dashboard: WORKING
🎉 SUCCESS: Basic bidirectional communication working!
]]>
</system-out>
</testcase>
<testcase name="Database conversation verification" classname="simple-homepage-widget-test.spec.ts" time="2.256">
<system-out>
<![CDATA[🔍 DATABASE CONVERSATION VERIFICATION
====================================
📋 Conversation Check Result: {
  "exists": true,
  "messageCount": 9,
  "data": {
    "messages": [
      {
        "id": "c278026b-4d50-439c-bebe-6365b2c9e291",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "Test message - 1754263632915",
        "senderType": "visitor",
        "senderId": "",
        "senderName": "Anonymous",
        "senderEmail": null,
        "createdAt": "2025-08-03T23:27:14.414882+00:00",
        "updatedAt": "2025-08-03T23:27:14.414882+00:00",
        "metadata": {},
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "visitor",
        "created_at": "2025-08-03T23:27:14.414882+00:00"
      },
      {
        "id": "bbfa973a-83ab-43a1-9b12-253af0f69866",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "MANUAL DATABASE TEST: Agent reply from direct DB insert",
        "senderType": "agent",
        "senderId": "",
        "senderName": "Test Agent",
        "senderEmail": null,
        "createdAt": "2025-08-03T23:52:50.595712+00:00",
        "updatedAt": "2025-08-03T23:52:50.595712+00:00",
        "metadata": {},
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "agent",
        "created_at": "2025-08-03T23:52:50.595712+00:00"
      },
      {
        "id": "5afd6285-fcf1-4d21-8d9f-c1d09d5a7d28",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "COMPREHENSIVE TEST: Agent reply 1754266869176",
        "senderType": "agent",
        "senderId": "6f9916c7-3575-4a81-b58e-624ab066bebc",
        "senderName": "jam@jam.com",
        "senderEmail": "jam@jam.com",
        "createdAt": "2025-08-04T00:21:10.446782+00:00",
        "updatedAt": "2025-08-04T00:21:10.446782+00:00",
        "metadata": {
          "source": "dashboard",
          "agent_id": "6f9916c7-3575-4a81-b58e-624ab066bebc",
          "timestamp": "2025-08-04T00:21:10.324Z"
        },
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "agent",
        "created_at": "2025-08-04T00:21:10.446782+00:00"
      },
      {
        "id": "577ec998-49e5-4058-8f8d-ab0f7eb003e7",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "ah ye",
        "senderType": "agent",
        "senderId": "",
        "senderName": "Support Agent",
        "senderEmail": null,
        "createdAt": "2025-08-04T00:36:04.546304+00:00",
        "updatedAt": "2025-08-04T00:36:04.546304+00:00",
        "metadata": {
          "source": "dashboard",
          "timestamp": "2025-08-04T00:36:04.229Z"
        },
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "agent",
        "created_at": "2025-08-04T00:36:04.546304+00:00"
      },
      {
        "id": "b5acbb4f-02b8-4763-8cc6-32544357ad4a",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "DIRECT API TEST: Dashboard to Widget 1754267988380",
        "senderType": "agent",
        "senderId": "6f9916c7-3575-4a81-b58e-624ab066bebc",
        "senderName": "jam@jam.com",
        "senderEmail": "jam@jam.com",
        "createdAt": "2025-08-04T00:39:49.248062+00:00",
        "updatedAt": "2025-08-04T00:39:49.248062+00:00",
        "metadata": {
          "source": "dashboard",
          "agent_id": "6f9916c7-3575-4a81-b58e-624ab066bebc",
          "timestamp": "2025-08-04T00:39:49.101Z"
        },
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "agent",
        "created_at": "2025-08-04T00:39:49.248062+00:00"
      },
      {
        "id": "b78951da-fa0e-4878-a1ea-7816f368b7b0",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "API TEST: Direct widget API call 1754270874037",
        "senderType": "visitor",
        "senderId": "",
        "senderName": "Test Visitor",
        "senderEmail": null,
        "createdAt": "2025-08-04T01:27:54.199638+00:00",
        "updatedAt": "2025-08-04T01:27:54.199638+00:00",
        "metadata": {},
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "visitor",
        "created_at": "2025-08-04T01:27:54.199638+00:00"
      },
      {
        "id": "8cdcaeda-cc49-41bc-a36f-b75ebd68cb60",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "API TEST: Direct widget API call 1754270976724",
        "senderType": "visitor",
        "senderId": "",
        "senderName": "Test Visitor",
        "senderEmail": null,
        "createdAt": "2025-08-04T01:29:36.932672+00:00",
        "updatedAt": "2025-08-04T01:29:36.932672+00:00",
        "metadata": {},
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "visitor",
        "created_at": "2025-08-04T01:29:36.932672+00:00"
      },
      {
        "id": "75cbe457-d3dd-4871-841b-ce898ec83825",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "BIDIRECTIONAL TEST: Widget message 1754271079852",
        "senderType": "visitor",
        "senderId": "",
        "senderName": "Test Visitor",
        "senderEmail": null,
        "createdAt": "2025-08-04T01:31:20.01986+00:00",
        "updatedAt": "2025-08-04T01:31:20.01986+00:00",
        "metadata": {},
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "visitor",
        "created_at": "2025-08-04T01:31:20.01986+00:00"
      },
      {
        "id": "56430338-a00d-4ab2-8e96-fa5c71bd3749",
        "conversationId": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "content": "FINAL TEST: Widget message with last_message_at fix",
        "senderType": "visitor",
        "senderId": "",
        "senderName": "Test User",
        "senderEmail": null,
        "createdAt": "2025-08-04T01:41:16.043248+00:00",
        "updatedAt": "2025-08-04T01:41:16.043248+00:00",
        "metadata": {},
        "attachments": [],
        "status": "sent",
        "inReplyToId": null,
        "isDeleted": false,
        "conversation_id": "8ddf595b-b75d-42f2-98e5-9efd3513ea4b",
        "sender_type": "visitor",
        "created_at": "2025-08-04T01:41:16.043248+00:00"
      }
    ],
    "count": 9
  }
}
✅ Conversation exists with 9 messages
]]>
</system-out>
</testcase>
</testsuite>
</testsuites>